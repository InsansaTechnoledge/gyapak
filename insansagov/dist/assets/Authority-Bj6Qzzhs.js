import{b as _,j as e,r as n,u as S,a as A,e as D,H as F,d as k,C}from"./index-BKMSpVWi.js";import{B as L}from"./building-2-D_CwcGLn.js";import{C as B}from"./clock-BzqQaU4u.js";import U from"./ViewMoreButton-COQiTmiz.js";import T from"./LatestUpdateCard-DxBI5d0l.js";import{R as M}from"./RelatedAuthorities-BIyrIq65.js";import{n as q}from"./no_data-ZhIxPc4_.js";import{u as I}from"./useQuery-BpjAa03Y.js";import"./chevron-down-C27PXoqE.js";import"./moment-C5S46NFB.js";import"./calendar-gh25dRrp.js";import"./TopAuthoritiesCard-CPTT7FEf.js";const V=s=>{const r=_();return e.jsx("div",{className:"w-full bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-purple-100",children:e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2 line-clamp-2",children:s.item?.name||"No Name Available"}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-4",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:s.authority})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:["Updated: ",s.item?.date_of_notification||"N/A"]})]}),e.jsx("button",{onClick:()=>r(`/opportunity?id=${encodeURI(s.item._id)}`),className:"bg-purple-600 text-white px-3 py-2 rounded-lg text-xs font-medium hover:bg-purple-700 transition-colors",children:"View Details"})]})})]})})},$=s=>{const[r,l]=n.useState(!1),[c,i]=n.useState(s.latestUpdates),[d,p]=n.useState(s.latestUpdates.slice(0,2)),g=()=>{l(!r),p(r?c.slice(0,2):c)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between mb-5",children:[e.jsx("div",{className:"font-bold text-2xl flex items-center",children:"Latest Updates"}),c.length>2&&e.jsx(U,{content:r?"view less ▲":"View More ▼",onClick:g})]}),s.titleHidden?null:e.jsx("div",{className:"space-y-5 mb-10",children:d&&d.map((m,x)=>e.jsx(T,{name:m.name,date:m.date_of_notification,organization:s.name,apply_link:m.apply_link},x))})]})},ae=()=>{const{apiBaseUrl:s,setApiBaseUrl:r}=S(),[l,c]=n.useState(!1),[i,d]=n.useState(),[p,g]=n.useState(),m=A(),[x,b]=n.useState(),[N,h]=n.useState(),[v,y]=n.useState(),w=new URLSearchParams(m.search).get("name"),z=async()=>{try{const t=await k.get(`${s}/api/organization/${w}`);if(t.status===201){d(t.data.organization),y(t.data.relatedOrganizations.filter(u=>u._id!==t.data.organization._id));const a=t.data.events.sort((u,j)=>{const f=new Date(u.notificationDate),E=new Date(j.notificationDate);return isNaN(f)||isNaN(E)?0:E-f});return g(a),b(a),h(a.slice(0,6)),t.data}}catch(t){if(console.log(t.response),t.response||t.request)if(t.response&&t.response.status>=500&&t.response.status<600||t.code==="ECONNREFUSED"||t.code==="ETIMEDOUT"||t.code==="ENOTFOUND"||t.code==="ERR_NETWORK"){console.log("RR");const a=await C();r(a)}else console.error("Error fetching state count:",t);else console.error("Error fetching state count:",t)}},{data:o,isLoading:O}=I({queryKey:["fetchOrganization/"+w,s],queryFn:z,staleTime:1/0,cacheTime:24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1});n.useEffect(()=>{if(o){y(o.relatedOrganizations.filter(a=>a._id!==o.organization._id));const t=o.events.sort((a,u)=>{const j=new Date(a.notificationDate),f=new Date(u.notificationDate);return isNaN(j)||isNaN(f)?0:f-j});g(t),b(t),h(t.slice(0,6)),d(o.organization)}},[o]);const R=()=>{c(!l),h(l?x.slice(0,6):x)};return O||!i?e.jsx("div",{className:"w-full h-screen flex justify-center",children:e.jsx(D,{size:60,color:"#5B4BEA",speedMultiplier:2,className:"my-auto"})}):e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx("title",{children:"gyapak"}),e.jsx("meta",{name:"description",content:"gyapak.in is a trusted source for the latest government exam updates, including exam dates, notifications, admit cards, and results for both central and state government departments. Stay updated with real-time information on competitive exams, application deadlines, and result announcements!"}),e.jsx("meta",{name:"keywords",content:"government exams, exam dates, admit cards, results, central government jobs, state government jobs, competitive exams, government jobs"}),e.jsx("meta",{property:"og:title",content:"gyapak"}),e.jsx("meta",{property:"og:description",content:"Find the latest updates on government exams, admit cards, results, and application deadlines for central and state government jobs."})]}),e.jsxs("div",{className:"pt-28",children:[e.jsxs("div",{className:"flex flex-col justify-center mb-20",children:[e.jsx("img",{src:`data:image/png;base64,${i.logo}`,className:"w-32 self-center mb-5"}),e.jsx("h1",{className:"text-3xl self-center font-bold mb-5",children:i.name}),e.jsx("div",{className:"self-center text-center",children:i.description})]}),N.length>0?e.jsxs(e.Fragment,{children:[e.jsx($,{latestUpdates:p,name:i.abbreviation}),e.jsxs("div",{className:"font-bold text-2xl flex items-center mb-5",children:["Events under ",i.name]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-7 mb-10",children:N&&N.map((t,a)=>e.jsx(V,{index:a,item:t,authority:i.abbreviation}))}),x.length>6?e.jsx("div",{className:"flex justify-center mb-20",children:e.jsx(U,{content:l?"view less ▲":"View More ▼",onClick:R})}):null]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-center font-bold text-lg mb-5",children:"No Active events right now!"}),e.jsx("img",{src:q,className:"w-5/12 mx-auto"})]}),v&&v.length>0?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl xl:text-3xl font-bold text-gray-900 mb-5",children:"Related Authorities"}),e.jsx(M,{organizations:v})]}):null]})]})};export{ae as default};
