import{b as k,j as e,r,u as F,a as R,f as B,H as T,e as _,C as I}from"./index-CZYuCXHJ.js";import{f as M}from"./dateFormatter-UefZsmRs.js";import{B as H}from"./building-2-DfC8jgKK.js";import{C as V}from"./clock-B6LiwziK.js";import z from"./ViewMoreButton-ByDi0biI.js";import q from"./LatestUpdateCard-BI0CICEW.js";import{R as $}from"./RelatedAuthorities-ByIKbHqU.js";import{n as P}from"./no_data-ZhIxPc4_.js";import{u as K}from"./useQuery-elcSJ7jO.js";import{E as W}from"./ExamCalendar-NPyd-5E6.js";import"./lodash-CZK75vGX.js";import"./pdf.worker-D6-XlEtG.js";import"./chevron-down-DfVBRg7e.js";import"./moment-C5S46NFB.js";import"./calendar-CvR1lCF7.js";import"./tag-vIwWp1yk.js";import"./TopAuthoritiesCard-Ds1dI8lW.js";const Q=s=>{const i=k();return e.jsx("div",{className:"w-full bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-purple-100",children:e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2 line-clamp-2",children:s.item?.name||"No Name Available"}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-4",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:s.authority})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:["Updated: ",s.item.updatedAt?M(s.item.updatedAt):"N/A"]})]}),e.jsx("button",{onClick:()=>i(`/opportunity?id=${encodeURI(s.item._id)}`),className:"bg-purple-600 text-white px-3 py-2 rounded-lg text-xs font-medium hover:bg-purple-700 transition-colors",children:"View Details"})]})})]})})},G=s=>{const[i,g]=r.useState(!1),[l,y]=r.useState(s.latestUpdates),[a,c]=r.useState(s.latestUpdates.slice(0,2)),f=()=>{g(!i),c(i?l.slice(0,2):l)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between mb-5",children:[e.jsx("div",{className:"font-bold text-2xl flex items-center",children:"Latest Updates"}),l.length>2&&e.jsx(z,{content:i?"view less ▲":"View More ▼",onClick:f})]}),s.titleHidden?null:e.jsx("div",{className:"space-y-5 mb-10",children:a&&a.map((o,h)=>e.jsx(q,{id:o._id,name:o.name,date:o.updatedAt,organization:s.name,apply_link:o.apply_link},h))})]})},pe=()=>{const{apiBaseUrl:s,setApiBaseUrl:i,setServerError:g}=F(),[l,y]=r.useState(!1),[a,c]=r.useState(),[f,o]=r.useState(),h=R(),[j,w]=r.useState(),[v,u]=r.useState(),[N,E]=r.useState(),[b,C]=r.useState(!1),U=new URLSearchParams(h.search).get("name"),O=async()=>{try{const t=await _.get(`${s}/api/organization/${U}`);if(t.status===201){c(t.data.organization),E(t.data.relatedOrganizations.filter(m=>m._id!==t.data.organization._id));const n=t.data.events.sort((m,p)=>{const x=new Date(m.updatedAt),A=new Date(p.updatedAt);return isNaN(x)||isNaN(A)?0:A-x});return o(n),w(n),u(n.slice(0,6)),t.data}}catch(t){if(console.log(t.response),t.response||t.request)if(t.response&&t.response.status>=500&&t.response.status<600||t.code==="ECONNREFUSED"||t.code==="ETIMEDOUT"||t.code==="ENOTFOUND"||t.code==="ERR_NETWORK"){const n=await I();i(n),g(t.response.status)}else console.error("Error fetching state count:",t);else console.error("Error fetching state count:",t)}},{data:d,isLoading:S}=K({queryKey:["fetchOrganization/"+U,s],queryFn:O,staleTime:1/0,cacheTime:24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1});r.useEffect(()=>{if(d){E(d.relatedOrganizations.filter(n=>n._id!==d.organization._id));const t=d.events.sort((n,m)=>{const p=new Date(n.updatedAt),x=new Date(m.updatedAt);return isNaN(p)||isNaN(x)?0:x-p});o(t),w(t),u(t.slice(0,6)),c(d.organization)}},[d]);const D=()=>{y(!l),u(l?j.slice(0,6):j)};if(S||!a)return e.jsx("div",{className:"w-full h-screen flex justify-center",children:e.jsx(B,{size:60,color:"#5B4BEA",speedMultiplier:2,className:"my-auto"})});const L=()=>{b?document.getElementById("view-calendar").innerHTML="View annual calendar":document.getElementById("view-calendar").innerHTML="Hide annual calendar",C(!b)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:[e.jsx("title",{children:"gyapak"}),e.jsx("meta",{name:"description",content:"gyapak.in is a trusted source for the latest government exam updates, including exam dates, notifications, admit cards, and results for both central and state government departments. Stay updated with real-time information on competitive exams, application deadlines, and result announcements!"}),e.jsx("meta",{name:"keywords",content:"government exams, exam dates, admit cards, results, central government jobs, state government jobs, competitive exams, government jobs"}),e.jsx("meta",{property:"og:title",content:"gyapak"}),e.jsx("meta",{property:"og:description",content:"Find the latest updates on government exams, admit cards, results, and application deadlines for central and state government jobs."})]}),e.jsxs("div",{className:"pt-28 bg-red",children:[e.jsxs("div",{className:"flex flex-col justify-center mb-20",children:[e.jsx("img",{src:`data:image/png;base64,${a.logo}`,className:"w-32 self-center mb-5"}),e.jsx("h1",{className:"text-3xl self-center font-bold mb-5",children:a.name}),e.jsx("div",{className:"self-center text-center",children:a.description})]}),a.calendar?e.jsx("div",{className:"flex justify-end mb-10",children:e.jsx("button",{id:"view-calendar",onClick:L,className:"py-3 px-4 rounded-md bg-purple-700 text-white font-medium",children:"View annual calendar"})}):null,b?e.jsx(W,{organizationId:a._id}):null,v.length>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{latestUpdates:f,name:a.abbreviation}),e.jsxs("div",{className:"font-bold text-2xl flex items-center mb-5",children:["Events under ",a.name]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-7 mb-10",children:v&&v.map((t,n)=>e.jsx(Q,{index:n,item:t,authority:a.abbreviation}))}),j.length>6?e.jsx("div",{className:"flex justify-center mb-20",children:e.jsx(z,{content:l?"view less ▲":"View More ▼",onClick:D})}):null]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-center font-bold text-lg mb-5",children:"No Active events right now!"}),e.jsx("img",{src:P,className:"w-5/12 mx-auto"})]}),N&&N.length>0?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl xl:text-3xl font-bold text-gray-900 mb-5",children:"Related Authorities"}),e.jsx($,{organizations:N})]}):null]})]})};export{pe as default};
