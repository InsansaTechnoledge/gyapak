const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StateCard-D7J4bjYH.js","assets/index-BFkRaJJ4.js","assets/index-BAQgaDza.css","assets/map-pin-DwFaY64X.js","assets/arrow-right-BIkcIdOP.js"])))=>i.map(i=>d[i]);
import{r,_ as F,u as P,b as B,e as x,C as p,j as e,S as I,f as q}from"./index-BFkRaJJ4.js";import{l as K}from"./lodash-CQds65ds.js";import{h as N}from"./moment-C5S46NFB.js";import{u as y}from"./useQuery-CAQNJghH.js";const w=r.lazy(()=>F(()=>import("./StateCard-D7J4bjYH.js"),__vite__mapDeps([0,1,2,3,4]))),G=()=>{const{apiBaseUrl:n,setApiBaseUrl:l,setServerError:c}=P();r.useState(!1);const[i,S]=r.useState("North"),[E,m]=r.useState(""),[a,h]=r.useState([]),[k,d]=r.useState(!1),[C,M]=r.useState(0),T=B();r.useEffect(()=>{if(a){const s=a?.length;M(s)}},[a]);const O=s=>{m(s),f(s)},R=s=>{T(`/state/?name=${s}`),m(s),d(!1)},f=K.debounce(async s=>{if(!s){h([]),d(!1);return}try{const t=await x.get(`${n}/api/search/state`,{params:{q:s.trim()}});h(t.data.suggestions),console.log(t.data.suggestions),d(!0)}catch(t){if(console.error("Error fetching suggestions:",t),t.response||t.request)if(t.response&&t.response.status>=500&&t.response.status<600||t.code==="ECONNREFUSED"||t.code==="ETIMEDOUT"||t.code==="ENOTFOUND"||t.code==="ERR_NETWORK"){const o=await p();l(o),c(t.response.status),setTimeout(()=>f(),1e3)}else console.error("Error fetching state count:",t);else console.error("Error fetching state count:",t)}},300),u={North:["Haryana","Himachal Pradesh","Punjab","Uttar Pradesh","Uttarakhand"],South:["Andhra Pradesh","Karnataka","Kerala","Tamil Nadu"],Central:["Madhya Pradesh","Maharashtra"],East:["Bihar","Odisha"],West:["Gujarat","Rajasthan"]};function Y(s){return s?typeof s=="number"?N(s).format("MMMM D, YYYY"):N(s,"YYYY-MM-DD").format("MMMM D, YYYY"):""}const D=({title:s,items:t,itemKey:o})=>!t||t.length===0?null:e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-gray-500 px-3 py-2 bg-gray-50 sticky top-0",children:[e.jsx("span",{children:s}),e.jsx("span",{className:"bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full text-xs",children:t.length})]}),e.jsx("div",{className:"custom-scrollbar",children:t&&t.map((v,A)=>e.jsx("div",{onClick:()=>R(v[o]),className:"px-4 py-2.5 hover:bg-blue-50 cursor-pointer text-gray-700 text-sm transition-colors duration-150",children:v[o]},A))})]}),g=async()=>{try{return(await x.get(`${n}/api/state/count`)).data}catch(s){if(s.response)if(s.response.status>=500&&s.response.status<600){console.error("ðŸš¨ Server Error:",s.response.status,s.response.statusText);const t=p();l(t),c(s.response.status),g()}else console.error("Error fetching state count:",s);else console.error("Error fetching state count:",s)}},b=async()=>{try{const s=await x.get(`${n}/api/event/lastupdated`);return Y(s.data.data)}catch(s){if(s.response)if(s.response.status>=500&&s.response.status<600){console.error("ðŸš¨ Server Error:",s.response.status,s.response.statusText);const t=p();l(t),c(s.response.status),b()}else console.error("Error fetching state count:",s);else console.error("Error fetching state count:",s)}},{data:j,isLoading1:U}=y({queryKey:["stateCount"],queryFn:g,staleTime:1/0,cacheTime:24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1}),{data:_,isLoading2:L}=y({queryKey:["lastUpdated"],queryFn:b,staleTime:1/0,cacheTime:24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1});return U||L?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          .custom-scrollbar::-webkit-scrollbar {
            width: 4px; /* Width of the scrollbar */
          }

          .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #888; /* Scrollbar thumb color */
            border-radius: 4px; /* Rounded corners */
          }

          .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background-color: #555; /* Thumb color on hover */
          }

          .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent; /* Scrollbar track background */
          }
        `}),e.jsxs("div",{className:"mt-8 mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-800 to-indigo-800 rounded-t-2xl p-4 sm:p-8 text-white",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"State Government authorities"}),e.jsx("p",{className:"text-purple-200 text-xs sm:text-sm",children:"Explore opportunities across India's public sector"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center bg-white/10 rounded-full p-2 backdrop-blur-sm",children:[e.jsx(I,{className:"h-4 w-4 text-purple-200 ml-2"}),e.jsx("input",{type:"text",onChange:s=>{O(s.target.value)},placeholder:"Search your state...",className:"bg-transparent border-none focus:outline-none text-white placeholder-purple-200 text-sm ml-2 w-48",autoComplete:"off",value:E})]}),e.jsx("div",{className:"relative",children:k&&a&&e.jsx("div",{className:"custom-scrollbar max-h-72 w-full overflow-auto absolute mt-1 bg-white border border-gray-200 rounded shadow-lg z-50",children:e.jsxs("div",{className:"",children:[a.length>0?e.jsx(D,{title:"States",items:a,itemKey:"name"}):null,C===0?e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"No suggestions found"}):null]})})})]})]})})}),e.jsx("div",{className:"bg-purple-900 text-white py-3 px-4 sm:px-8 overflow-x-auto",children:e.jsxs("div",{className:"flex justify-center space-x-6 sm:space-x-12 text-xs sm:text-sm whitespace-nowrap",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold",children:j?.states}),e.jsx("div",{className:"text-purple-200 text-xs",children:"States"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold",children:j?.exams}),e.jsx("div",{className:"text-purple-200 text-xs",children:"Active Exams"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold",children:"1M+"}),e.jsx("div",{className:"text-purple-200 text-xs",children:"Candidates"})]})]})}),e.jsxs("div",{className:"bg-gradient-to-b from-purple-50 to-white rounded-b-2xl p-4 sm:p-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-4 whitespace-nowrap p-1",children:Object.keys(u).map(s=>e.jsx("button",{onClick:()=>S(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i===s?"bg-purple-800 text-white":"bg-purple-100 text-purple-800 hover:bg-purple-200"}`,children:s},s))})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:e.jsx("div",{className:"w-full h-screen flex justify-center",children:e.jsx(q,{size:60,color:"#5B4BEA",speedMultiplier:2,className:"my-auto"})})}),children:i?u[i].map((s,t)=>e.jsx(w,{state:s},t)):Object.values(u).flat().map((s,t)=>e.jsx(w,{state:s},t))})}),e.jsx("div",{className:"mt-6 sm:mt-8 text-center",children:e.jsxs("p",{className:"text-xs sm:text-sm text-purple-600",children:["Last updated: ",_]})})]})]})]})};export{G as default};
