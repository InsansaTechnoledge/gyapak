const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LatestUpdateCard-CXnf8Q_i.js","assets/index-C6Rqu_Ax.js","assets/index-BAQgaDza.css","assets/moment-C5S46NFB.js","assets/calendar-CeeSfMf3.js","assets/ViewMoreButton-Ddmj7dbL.js","assets/chevron-down-DhxHktTZ.js"])))=>i.map(i=>d[i]);
import{r as a,_ as d,u as E,j as s,f as L,e as v}from"./index-C6Rqu_Ax.js";import{u as U}from"./useQuery-CQVbgv42.js";const N=a.lazy(()=>d(()=>import("./LatestUpdateCard-CXnf8Q_i.js"),__vite__mapDeps([0,1,2,3,4]))),w=a.lazy(()=>d(()=>import("./ViewMoreButton-Ddmj7dbL.js"),__vite__mapDeps([5,1,2,6]))),k=({titleHidden:u})=>{const{apiBaseUrl:f,setApiBaseUrl:p,setServerError:x}=E(),[n,m]=a.useState(!1),[h,o]=a.useState([]),_=()=>{o(n?t.slice(0,2):t),m(!n)},i=async()=>{try{const e=await v.get(`${f}/api/event/latest`);if(e.status===201)return e.data.sort((g,y)=>{const c=new Date(g.date_of_notification),l=new Date(y.date_of_notification);return isNaN(c)||isNaN(l)?0:l-c}).slice(0,2)}catch(e){if(console.error("Error fetching latest updates:",e),e.response)if(e.response.status>=500&&e.response.status<600){console.error("ðŸš¨ Server Error:",e.response.status,e.response.statusText);const r=CheckServer();p(r),x(e.response.status),i()}else console.error("Error fetching state count:",e);else console.error("Error fetching state count:",e)}},{data:t,isLoading:j}=U({queryKey:["latestUpdates"],queryFn:i,staleTime:1/0,cacheTime:24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1});return a.useEffect(()=>{t&&o(t.slice(0,2))},[t]),j?s.jsx("div",{children:"Loading..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between mb-5",children:[s.jsx("div",{className:"font-bold text-2xl flex items-center",children:"Latest Updates"}),s.jsx(a.Suspense,{fallback:s.jsx("div",{children:s.jsx("div",{className:"w-full h-screen flex justify-center",children:s.jsx(L,{size:60,color:"#5B4BEA",speedMultiplier:2,className:"my-auto"})})}),children:t&&t.length>2?s.jsx(s.Fragment,{children:s.jsx(w,{content:n?"View Less â–²":"View More â–¼",onClick:_})}):null})]}),!u&&s.jsx("div",{className:"space-y-5 mb-10",children:s.jsx(a.Suspense,{fallback:s.jsx("div",{children:"Loading updates..."}),children:h.map((e,r)=>s.jsx(N,{name:e.name,date:e.date_of_notification,organization:e.organizationName,apply_link:e.apply_link},e.id||r))})})]})};export{k as default};
