import{c as u,e as g,r as i,j as e,S as V}from"./index-DjxcMD6C.js";import{X as W}from"./x-BUrWpQNt.js";import{R as X}from"./refresh-cw-CoK_F8KG.js";import{T as G}from"./triangle-alert-DC1DIMXF.js";import{C as F}from"./clock-C-IHfWWS.js";import{T as E}from"./tag-D0ZV4YHg.js";import{E as L}from"./external-link-CIBo72GG.js";import{C as K}from"./calendar-DN9UUA10.js";import{B as Q}from"./book-open-HhlNlENc.js";import"./pdf.worker-D6-XlEtG.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=u("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=u("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=u("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=u("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),se=async()=>(await g.get(`${f}/api/v1i2/affair/all`,{withCredentials:!0})).data,f="https://gyapak-admin2.onrender.com",ae=async()=>(await g.get(`${f}/api/v1i2/affair/today`,{withCredentials:!0})).data,re=async(d,x)=>(await g.get(`${f}/api/v1i2/affair/month?month=${d}&year=${x}`,{withCredentials:!0})).data,le=async d=>(await g.get(`${f}/api/v1i2/affair/year?year=${d}`,{withCredentials:!0})).data;function ye(){const[d,x]=i.useState([]),[m,y]=i.useState(""),[j,Y]=i.useState(""),[h,I]=i.useState(""),[k,$]=i.useState(""),[A,R]=i.useState(""),[B,ne]=i.useState(!1),[b,T]=i.useState(!0),[v,O]=i.useState("all"),[C,S]=i.useState(null),N=async(t=v)=>{T(!0),S(null);try{let a;switch(t){case"today":a=await ae();break;case"monthly":{const l=new Date,c=j||l.getMonth()+1,p=h||l.getFullYear();a=await re(c,p);break}case"yearly":{const l=new Date().getFullYear();a=await le(h||l);break}case"all":default:a=await se();break}const n=Array.isArray(a.data)?a.data:[];let r=[];n.forEach(l=>{Array.isArray(l.affairs)&&l.affairs.length>0&&l.affairs.forEach(c=>{r.push({...c,date:l.date,mediaType:c.videoUrl?"video":c.imageUrl?"image":"text",mediaUrl:c.videoUrl||c.imageUrl||null})})}),x(r)}catch{S("Failed to load current affairs. Please try again later.")}finally{T(!1)}};i.useEffect(()=>{N()},[]),[...new Set(d.map(t=>t.category))],[...new Set(d.map(t=>t.date?.split("-")[0]))];const _=["January","February","March","April","May","June","July","August","September","October","November","December"],w=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),J=t=>{O(t),N(t)},M=()=>{N(v)},z=t=>{switch(t){case"image":return e.jsx(te,{size:16});case"video":return e.jsx(ee,{size:16});case"audio":return e.jsx(D,{size:16});case"text":default:return e.jsx(Q,{size:16})}},o=d.filter(t=>{const a=m===""||t.title?.toLowerCase().includes(m.toLowerCase())||t.content?.toLowerCase().includes(m.toLowerCase()),n=k===""||t.category===k,r=h===""||t.date?.startsWith(h),l=j===""||t.date?.split("-")[1]===String(_.findIndex(p=>p===j)+1).padStart(2,"0"),c=A===""||t.mediaType===A;return a&&n&&r&&l&&c}),U=o.reduce((t,a)=>{const n=a.date?.split("T")[0];return t[n]||(t[n]=[]),t[n].push(a),t},{}),q=Object.keys(U).sort((t,a)=>new Date(a)-new Date(t)),H=()=>{$(""),I(""),Y(""),R(""),y("")},P=t=>{if(!t.mediaUrl)return null;switch(t.mediaType){case"image":return e.jsx("div",{className:"mb-4 relative aspect-video rounded-lg overflow-hidden",children:e.jsx("img",{src:t.mediaUrl||"/api/placeholder/800/450",alt:t.title,className:"w-full h-full object-cover",onError:a=>{a.target.src="/api/placeholder/800/450",a.target.alt="Image unavailable"}})});case"video":return e.jsx("div",{className:"mb-4 relative aspect-video rounded-lg overflow-hidden",children:e.jsx("video",{src:t.mediaUrl,className:"w-full h-full object-cover",controls:!0,poster:"/api/placeholder/800/450",children:"Your browser does not support the video tag."})});case"audio":return e.jsxs("div",{className:"mb-4 bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(D,{className:"text-purple-700 mr-2"}),e.jsx("span",{className:"text-purple-800 font-medium",children:"Audio Content"})]}),e.jsxs("audio",{controls:!0,className:"w-full",children:[e.jsx("source",{src:t.mediaUrl}),"Your browser does not support the audio element."]})]});default:return null}},s=(()=>{if(o.length===0)return null;const t=o.filter(r=>r.mediaType==="image"||r.mediaType==="video"),a=t.length>0?t:o,n=Math.floor(Math.random()*a.length);return a[n]})();return s&&o.filter(t=>t!==s),e.jsxs("div",{className:"min-h-screen px-2 sm:px-4",children:[e.jsx("header",{className:"bg-white  pt-32 mx-auto ",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("h1",{className:"text-5xl font-bold text-purple-800 mb-3 relative inline-block",children:[e.jsx("span",{className:"relative z-10",children:"Current Affairs"}),e.jsx("span",{className:"absolute -bottom-2 left-0 w-full h-2 bg-purple-200 transform -rotate-1 rounded z-0"})]}),e.jsxs("p",{className:"text-lg text-gray-600 mt-1 max-w-xl mx-auto md:mx-0",children:["Curated headlines & insights from ",e.jsx("span",{className:"text-purple-700 font-semibold",children:"gyapak"}),"."]})]}),e.jsxs("div",{className:"relative w-full max-w-md hidden md:block",children:[e.jsx("input",{type:"text",placeholder:"Search current affairs...",className:"w-full pl-10 pr-10 py-2  rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition",value:m,onChange:t=>y(t.target.value)}),e.jsx(V,{className:"absolute left-3 top-2.5 text-gray-400 w-5 h-5"}),m&&e.jsx("button",{className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",onClick:()=>y(""),children:e.jsx(W,{size:16})})]}),e.jsx("div",{className:"flex items-center gap-3 ml-4",children:e.jsx("button",{className:`p-2 rounded-full hover:bg-purple-50 text-gray-600 ${b?"animate-spin":""}`,onClick:M,disabled:b,children:e.jsx(X,{size:20})})})]}),e.jsx("div",{className:"mt-5 flex flex-wrap gap-4 border-t border-gray-100 pt-4",children:["all","today","monthly","yearly"].map(t=>e.jsxs("button",{className:`px-4 py-2 text-sm font-medium rounded-full transition ${v===t?"bg-purple-100 text-purple-800 shadow-sm":"text-gray-600 hover:text-purple-600 hover:bg-gray-100"}`,onClick:()=>J(t),children:[t==="all"&&"All Affairs",t==="today"&&"Today's Highlights",t==="monthly"&&"Monthly Archive",t==="yearly"&&"Yearly Archive"]},t))}),B&&e.jsx("div",{className:"mt-4"})]})}),e.jsx("main",{className:"container mx-auto px-4  pb-12",children:b?e.jsx("div",{className:"flex justify-center py-20",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm pt-28 text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-300 border-t-purple-600 rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading current affairs..."})]})}):C?e.jsxs("div",{className:"bg-red-50 p-6 pt-48 rounded-lg text-center",children:[e.jsx(G,{size:48,className:"mx-auto text-red-500 mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-red-800 mb-2",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-red-600 mb-4",children:C}),e.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-medium",onClick:M,children:"Try Again"})]}):o.length>0?e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"mb-12",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-100",children:[s.mediaType==="image"&&s.mediaUrl&&e.jsxs("div",{className:"relative aspect-[16/9] sm:h-64 md:h-80 lg:h-[420px] w-full",children:[e.jsx("img",{src:s.mediaUrl||"/api/placeholder/1200/400",alt:s.title,className:"absolute inset-0 w-full h-full object-cover",onError:t=>{t.target.src="/api/placeholder/1200/400",t.target.alt="Image unavailable"}}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:s.category})})]}),s.mediaType==="video"&&s.mediaUrl&&e.jsxs("div",{className:"relative aspect-video w-full",children:[e.jsx("video",{src:s.mediaUrl,className:"w-full h-full object-cover",controls:!0,poster:"/api/placeholder/1200/400",children:"Your browser does not support the video tag."}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:s.category})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-3",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(F,{size:14,className:"mr-1"}),w(s.date)]}),s.mediaType&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsxs("span",{className:"flex items-center",children:[z(s.mediaType),e.jsx("span",{className:"ml-1",children:s.mediaType.charAt(0).toUpperCase()+s.mediaType.slice(1)})]})]})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3 hover:text-purple-700 transition-colors",children:s.title}),e.jsx("p",{className:"text-gray-700 mb-5 leading-relaxed text-lg",children:s.content}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-5",children:s.tags?.map((t,a)=>e.jsxs("span",{className:"inline-flex items-center text-xs text-purple-600 bg-purple-50 px-3 py-1 rounded-full",children:[e.jsx(E,{size:12,className:"mr-1"}),t]},a))}),s.source&&e.jsxs("div",{className:"flex items-center text-sm text-purple-600 hover:text-purple-800",children:[e.jsx(L,{size:14,className:"mr-1"}),e.jsxs("a",{href:s.source,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:["Source: ",s.source.replace(/(^\w+:|^)\/\//,"").split("/")[0]]})]})]})]})}),q.map(t=>{const n=U[t].filter(r=>r!==s);return n.length===0?null:e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:e.jsx(K,{className:"text-purple-700",size:20})}),e.jsx("h2",{className:"text-lg font-bold text-purple-800",children:w(t)})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map((r,l)=>e.jsx("article",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden border border-gray-100",children:e.jsxs("div",{className:"p-6",children:[P(r),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium",children:r.category}),e.jsxs("div",{className:"flex gap-2 items-center",children:[r.mediaType&&e.jsxs("span",{className:"flex items-center text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[z(r.mediaType),e.jsx("span",{className:"ml-1",children:r.mediaType.charAt(0).toUpperCase()+r.mediaType.slice(1)})]}),e.jsxs("span",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(F,{size:14,className:"mr-1"}),w(r.date)]})]})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3 hover:text-purple-700 transition-colors",children:r.title}),e.jsx("p",{className:"text-gray-700 mb-5 leading-relaxed line-clamp-3",children:r.content}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-5",children:r.tags&&r.tags.map((c,p)=>e.jsxs("span",{className:"inline-flex items-center text-xs text-purple-600 bg-purple-50 px-3 py-1 rounded-full",children:[e.jsx(E,{size:12,className:"mr-1"}),c]},p))}),r.source&&e.jsxs("div",{className:"flex items-center text-sm text-purple-600 hover:text-purple-800",children:[e.jsx(L,{size:14,className:"mr-1"}),e.jsxs("a",{href:r.source,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:["Source: ",r.source.replace(/(^\w+:|^)\/\//,"").split("/")[0]]})]})]})},l))})]},t)})]}):e.jsx("div",{className:"flex justify-center py-20",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Z,{size:24,className:"text-purple-700"})}),e.jsx("h3",{className:"text-xl font-medium text-gray-800 mb-2",children:"No current affairs found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search or filters to find what you're looking for"}),e.jsx("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-medium",onClick:H,children:"Clear Filters"})]})})})]})}export{ye as default};
