import{u as D,r as t,j as e,e as C}from"./index-CZYuCXHJ.js";const z=({organizationId:h})=>{const{apiBaseUrl:f}=D(),[g,p]=t.useState(),[L,l]=t.useState(!0),[a,v]=t.useState(1),[x,P]=t.useState(0),[m,b]=t.useState(1),[j,i]=t.useState(null),k=t.useRef(null),o=t.useRef(null),[y,E]=t.useState(null),[r,N]=t.useState(!1);t.useEffect(()=>{h&&(async()=>{try{l(!0),i(null);const n=await C.get(`${f}/api/organization/calendar/${h}`);n.status===200&&p(n.data.calendar)}catch(n){console.error("Failed to fetch calendar:",n),i("Unable to load exam calendar. Please try again later."),l(!1)}})()},[h,f]),t.useEffect(()=>{if(!g)return;const n=setTimeout(async()=>{try{if(!window.pdfjsLib){i("PDF.js library not loaded. Please check your connection and refresh the page."),l(!1);return}const u=await window.pdfjsLib.getDocument({url:g,withCredentials:!1,cMapUrl:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/cmaps/",cMapPacked:!0}).promise;E(u),P(u.numPages),l(!1),F(u,1)}catch(c){console.error("Error initializing PDF viewer:",c),i("Failed to load the PDF. Please check your connection and try again."),l(!1)}},100);return()=>clearTimeout(n)},[g]),t.useEffect(()=>{y&&F(y,a)},[m,a]);const F=async(s,n)=>{if(s)try{const c=await s.getPage(n),d=k.current;if(!d)return;const u=d.getContext("2d"),w=c.getViewport({scale:m});d.height=w.height,d.width=w.width,u.clearRect(0,0,d.width,d.height);const W={canvasContext:u,viewport:w};await c.render(W).promise}catch(c){console.error("Error rendering page:",c),i(`Failed to render page ${n}. Please try again.`)}},M=()=>{a>1&&v(s=>s-1)},S=()=>{a<x&&v(s=>s+1)},R=()=>{b(s=>Math.min(3,s+.2))},$=()=>{b(s=>Math.max(.5,s-.2))},q=()=>{r?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():o.current.requestFullscreen?o.current.requestFullscreen():o.current.mozRequestFullScreen?o.current.mozRequestFullScreen():o.current.webkitRequestFullscreen?o.current.webkitRequestFullscreen():o.current.msRequestFullscreen&&o.current.msRequestFullscreen(),N(!r)};t.useEffect(()=>{const s=()=>{N(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",s),()=>{document.removeEventListener("fullscreenchange",s)}},[]);const B=()=>{i(null),l(!0),h&&(async()=>{try{const n=await C.get(`${f}/api/organization/calendar/${h}`);n.status===200&&p(n.data.calendar)}catch(n){console.error(n),i("Failed to load the calendar. Please try again later."),l(!1)}})()};return L?e.jsxs("div",{className:"w-full h-64 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin"}),e.jsx("p",{className:"mt-4 text-indigo-600 font-medium",children:"Loading exam calendar..."})]}):j?e.jsx("div",{className:"w-full bg-red-50 p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-red-800",children:j}),e.jsx("button",{onClick:B,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Try Again"})]})}):e.jsxs("div",{ref:o,className:`transition-all duration-300 ${r?"bg-gray-900 p-4":"mb-6"}`,children:[e.jsx("style",{children:`
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .hide-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  `}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:`relative overflow-auto hide-scrollbar bg-white ${r?"rounded-none":"rounded-lg shadow-md"}`,style:{maxHeight:r?"100vh":"70vh"},children:e.jsx("div",{className:"flex justify-center min-h-64 hide-scrollbar p-1",children:e.jsx("canvas",{ref:k,className:"max-w-full"})})}),e.jsxs("div",{className:`flex items-center justify-between ${r?"bg-gray-800 text-white mt-2 p-3 rounded-lg":"bg-white mt-4 p-2 rounded-lg shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:$,className:`p-2 rounded-full ${r?"hover:bg-gray-700":"hover:bg-gray-100"} focus:outline-none focus:ring-2 focus:ring-indigo-500`,disabled:m<=.5,"aria-label":"Zoom Out",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 12H4"})})}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(m*100),"%"]}),e.jsx("button",{onClick:R,className:`p-2 rounded-full ${r?"hover:bg-gray-700":"hover:bg-gray-100"} focus:outline-none focus:ring-2 focus:ring-indigo-500`,"aria-label":"Zoom In",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:M,className:`p-2 rounded-full ${r?"hover:bg-gray-700":"hover:bg-gray-100"} focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50`,disabled:a<=1,"aria-label":"Previous Page",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsxs("span",{className:"mx-3 text-sm font-medium",children:[a," / ",x]}),e.jsx("button",{onClick:S,className:`p-2 rounded-full ${r?"hover:bg-gray-700":"hover:bg-gray-100"} focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:opacity-50`,disabled:a>=x,"aria-label":"Next Page",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:q,className:`p-2 rounded-full ${r?"hover:bg-gray-700":"hover:bg-gray-100"} focus:outline-none focus:ring-2 focus:ring-indigo-500`,"aria-label":r?"Exit Fullscreen":"Enter Fullscreen",children:r?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"})})})]})]})]})};export{z as E};
